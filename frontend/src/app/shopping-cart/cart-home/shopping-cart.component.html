<div class="main">

  <div class="header-container" *ngIf="!isCartEmpty">
    <h1 class="header-text">Your Cart</h1>
  </div>

  <img *ngIf="isCartEmpty" style="height: 20%; width: 20%" src="../../../assets/empty-cart.gif">
  <p *ngIf="isCartEmpty" style="font-size: 26px">Your cart is currently empty</p>
  <button *ngIf="isCartEmpty" class="button-market-redirect" (click)="marketplaceRedirect()">Go shopping</button>


  <div *ngIf="!isCartEmpty" class="row">
    <div class="col-12 col-lg-8 cart-data-container p-0">
      <div class="cart-data">
        <!-- <div class="row border-bottom">
          <div class="col-12 col-sm-6">
            <h2>{{cartItems?.length}} Items</h2>
          </div>
        </div> -->
        <div class="row cart_title pt-4 pb-2 border-bottom">
          <div class="col-4">
            <h4>Product</h4>
          </div>
          <div class="col-2">
            <h4>Quantity</h4>
          </div>
          <div class="col-2">
            <h4>Seller</h4>
          </div>
          <div class="col-2">
            <h4>Price</h4>
          </div>
          <div class="col-2">
            <h4>Total</h4>
          </div>
        </div>
        <div *ngFor="let item of cartItems; let i = index" class="row product-list pb-4 border-bottom"
          style="margin-top: 20px">
          <div class="col-4">
            <div class="row">
              <div class="col-2 item_center p-0">
                <div>
                  <button mat-icon-button (click)="removeCartItem(i)">
                    <mat-icon>close</mat-icon>
                  </button>
                </div>
              </div>
              <div class="col-5 item_center">
                <img class="product-image" src="../../../assets/leaf.png" />
              </div>
              <div class="col-5 item_center">
                <p class="product-item">{{ item.produce.foodName }}</p>
              </div>
            </div>
          </div>
          <div class="col-2 item_center">
            <p class="product-item">{{item.counter}}</p>
          </div>
          <div class="col-2 item_center">
            <p class="product-item">{{ item.user.displayName }}</p>
          </div>
          <div class="col-2 item_center">
            <p class="product-item">{{
              item.produce.price + "" | currency : "USD" : "symbol" : "1.2-2"
              }}</p>
          </div>
          <div class="col-2 item_center">
            <p class="product-item">{{
              item.counter * item.produce.price + ""
              | currency : "USD" : "symbol" : "1.2-2"
              }}</p>
          </div>
        </div>
      </div>
    </div>

    <div class="col-12 col-lg-4 order-summary p-0" *ngIf="!isCartEmpty">
      <div class="checkout">
        <div class="row border-bottom">
          <div class="col-12">
            <h1>Order Summary for {{cartItems?.length}} Items</h1>
          </div>
        </div>
        <div class="row pt-4 pb-2 border-bottom">
          <div class="col-8">
            <p class="checkoutItem">Subtotal</p>
          </div>
          <div class="col-4">
            <p class="checkoutItem text-end">{{ grandTotal | currency : "USD" : "symbol" : "1.2-2" }}</p>
          </div>
          <div class="col-8">
            <p class="checkoutItem">Sales Tax</p>
          </div>
          <div class="col-4">
            <p class="checkoutItem text-end">{{ grandTotal * 0.13 | currency : "USD" : "symbol" : "1.2-2" }}</p>
          </div>
        </div>
        <div class="row pt-3">
          <div class="col-8">
            <p class="checkoutTotal">Grand Total</p>
          </div>
          <div class="col-4">
            <p class="checkoutTotal text-end">{{ grandTotal * taxRate | currency : "USD" : "symbol" : "1.2-2" }}</p>
          </div>
        </div>
        <button class="checkout-btn" (click)="openConfirmationDialog()">
          Checkout
        </button>
        <button class="clearCart" (click)="clearCartItems()">
          clear cart
        </button>
      </div>
    </div>
  </div>
  <!-- <div class="cart-summary">
    <div class="user-cart">
      <div *ngIf="!isCartEmpty" class="label-container">
        <p></p>
        <p></p>
        <p class="label-name">Name</p>
        <p class="label-qoh">Qty</p>
        <p class="label-seller">Seller</p>
        <p class="label-price">Price</p>
        <p class="label-total-price">Total</p>
        <p></p>
      </div>

      <div class="grid-container" *ngIf="!isCartEmpty">
        <ng-container *ngFor="let item of cartItems; let i = index">
          <div class="item-data">
            <div>
              <img class="product-image" src="assets/Pumpkin.jpg" /> <br />
              Max: {{ item.produce.qoh }}
            </div>

            <p class="product-name">{{ item.produce.foodName }}</p>

            <p class="product-qoh">
              {{item.counter}}
            </p>

            <p class="product-seller">{{ item.user.displayName }}</p>
            <p class="product-price">
              {{
              item.produce.price + "" | currency : "USD" : "symbol" : "1.2-2"
              }}
            </p>
            <p class="product-total-price">
              {{
              item.counter * item.produce.price + ""
              | currency : "USD" : "symbol" : "1.2-2"
              }}
            </p>

            <div class="action-icons">
              <button mat-icon-button (click)="removeCartItem(i)">
                <mat-icon>cancel</mat-icon>
              </button>
            </div>
          </div>
        </ng-container>
      </div>
    </div>
  </div> -->



  <!-- <div class="totals-container" *ngIf="!isCartEmpty">
    <div class="sub-total">
      Subtotal: {{ grandTotal | currency : "USD" : "symbol" : "1.2-2" }}
    </div>
    <div class="sales-tax">
      Sales Tax:
      {{ grandTotal * 0.13 | currency : "USD" : "symbol" : "1.2-2" }}
    </div>
    <hr width="50%">
    <div class="grand-total">
      Grand total:
      {{ grandTotal * taxRate | currency : "USD" : "symbol" : "1.2-2" }}
    </div>
    <div class="cart-actions">
      <div class="purchase-button">
        <button (click)="openConfirmationDialog()">Checkout</button>
      </div>
      <div class="clear-cart-button">
        <button (click)="clearCartItems()">Clear Cart</button>
      </div>
    </div>
  </div> -->